<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TesteHTML Publisher - Frontend Only</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Segoe UI', Tahoma, Verdana, sans-serif;
      background:linear-gradient(135deg,#667eea,#764ba2);
      min-height:100vh; display:flex;
      align-items:center; justify-content:center;
      padding:20px;
    }
    .container {
      background:#fff; border-radius:15px;
      box-shadow:0 20px 60px rgba(0,0,0,0.1);
      padding:40px; width:100%; max-width:900px;
    }
    .header { text-align:center; margin-bottom:30px; }
    .header h1 { color:#333; font-size:2.5em; margin-bottom:10px; }
    .header p  { color:#666; font-size:1.1em; }
    label { display:block; margin:18px 0 8px; font-weight:bold; color:#333; }
    input, textarea {
      width:100%; padding:12px; border:2px solid #ddd;
      border-radius:8px; font-size:14px; font-family:monospace;
    }
    textarea { min-height:220px; resize:vertical; }
    .btn {
      width:100%; padding:15px; background:linear-gradient(135deg,#667eea,#764ba2);
      color:#fff; border:none; border-radius:8px; cursor:pointer;
      font-size:16px; font-weight:bold; margin-top:10px; transition:.2s;
    }
    .btn:hover { transform:translateY(-2px); box-shadow:0 10px 25px rgba(0,0,0,0.2); }
    .btn-secondary { background:#28a745; margin-top:10px; }
    .status { margin-top:20px; padding:15px; border-radius:8px; display:none; }
    .status.loading { background:#d1ecf1; color:#0c5460; }
    .status.success { background:#d4edda; color:#155724; }
    .status.error   { background:#f8d7da; color:#721c24; }
    .token-info {
      background:#fff3cd; color:#856404; padding:15px; border-radius:8px;
      border:1px solid #ffeaa7; margin-bottom:20px; margin-top:-10px;
    }
    .token-info strong { color:#533f03; }
    @media(max-width:768px) { .container{padding:20px;} }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üöÄ TesteHTML Publisher</h1>
      <p>Edite e publique qualquer HTML direto no GitHub (pasta <b>testeHTML</b>)</p>
    </div>
    <div class="token-info">
      <strong>‚ö†Ô∏è Importante:</strong> API GitHub direto do navegador.<br>
      Token pr√©-configurado (<code>tehewdev/tehew.space</code>), pasta <b>testeHTML/</b>.
    </div>

    <form id="publishForm">
      <label for="filename">Nome do arquivo (.html):</label>
      <input type="text" id="filename" value="minha-pagina.html" required>

      <label for="htmlContent">C√≥digo HTML:</label>
      <textarea id="htmlContent" required>
<!DOCTYPE html>
<html lang="pt-BR">
<head><meta charset="UTF-8"><title>Exemplo</title></head>
<body><h1>Ol√°, TesteHTML!</h1><p>Sim, funciona na pasta testeHTML :)</p></body>
</html>
      </textarea>
      <button type="button" class="btn btn-secondary" id="loadExampleBtn">üìã Carregar Exemplo</button>
      <button type="submit" class="btn" id="publishBtn">üöÄ Publicar no GitHub</button>
    </form>
    <div id="status" class="status"></div>
  </div>

<script>
const repoOwner   = 'tehewdev';
const repoName    = 'tehew.space';
const folder      = 'testeHTML';
const githubToken = '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';

function showStatus(msg, cls) {
  const s=document.getElementById('status');
  s.textContent=msg; s.className='status '+cls; s.style.display='block';
}

function sanitize(n){
  return n.toLowerCase()
    .replace(/[^a-z0-9-_.]/g,'-')
    .replace(/-+/g,'-')
    .replace(/^-|-$/g,'');
}

async function publicar(){
  const filename=document.getElementById('filename').value.trim();
  const html=document.getElementById('htmlContent').value.trim();
  if(!filename||!html){
    showStatus('Preencha nome e conte√∫do HTML!','error');return;
  }
  const sanitized=sanitize(filename);
  const path = `${folder}/${sanitized}`;
  const url  = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}`;
  showStatus('Publicando...','loading');

  let sha=null;
  try {
    const resHead=await fetch(url,{headers:{'Authorization':'Bearer '+githubToken}});
    if(resHead.ok){const j=await resHead.json(); sha=j.sha;}
  }catch{}

  const commitData={message:`Publicando ${sanitized}`,content:btoa(unescape(encodeURIComponent(html))),branch:'main'};
  if(sha) commitData.sha = sha;

  const res=await fetch(url,{
    method:'PUT',
    headers:{
      'Authorization':'Bearer '+githubToken,
      'Content-Type':'application/json'
    },
    body:JSON.stringify(commitData)
  });
  const r=await res.json();
  if(res.ok){
    showStatus(`Publicado! <a href="https://tehew.space/${folder}/${sanitized}" target="_blank">${folder}/${sanitized}</a>`,'success');
  } else {
    showStatus(`Erro: ${r.message}`,'error');
  }
}

document.getElementById('publishForm').addEventListener('submit',e=>{
  e.preventDefault(); publicar();
});
document.getElementById('loadExampleBtn').addEventListener('click',()=>{
  document.getElementById('htmlContent').value = `
<!DOCTYPE html>
<html lang="pt-BR">
<head><meta charset="UTF-8"><title>P√°gina Exemplo</title></head>
<body>
  <h1>Funciona 100%!</h1>
  <p>Diret√≥rio correto: <b>testeHTML/</b> no GitHub.</p>
  <p>Publique agora e acesse pelo Render ou GitHub Pages.</p>
</body>
</html>`;
  showStatus('Exemplo carregado!','success');
});
</script>
</body>
</html>
