<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TesteHTML Publisher Pro - COMPLETO</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <style>
    body {font-family: 'Inter', sans-serif;background: linear-gradient(135deg,#667eea,#764ba2);color:#333;margin:0;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:24px;}
    .container {background:#fff;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.15);padding:32px;max-width:1200px;width:100%;}
    h1{text-align:center;margin:0 0 16px;color:#333;}
    .stats{display:flex;gap:16px;justify-content:center;margin-bottom:20px;}
    .stat{background:#f2f3ff;border-radius:8px;padding:6px 12px;font-size:13px;}
    .editor{position:relative;background:#1e1e1e;border-radius:10px;overflow:hidden;}
    .line-numbers{background:#2b2b2b;color:#999;padding:16px;text-align:right;user-select:none;min-width:40px;}
    .editor textarea{flex:1;background:transparent;color:#ddd;font-family:'Fira Code',monospace;font-size:14px;border:none;outline:none;padding:16px;resize:none;}
    .editor-wrapper{display:flex;overflow:auto;max-height:400px;}
    .btn{padding:10px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:.2s;}
    .btn-primary{background:#667eea;color:#fff;}
    .btn-primary:hover{background:#764ba2;}
    .btn-secondary{background:#eef1ff;color:#667eea;}
    .file-list{margin-top:24px;background:#f8f9fa;padding:16px;border-radius:10px;}
    .file-item{display:flex;justify-content:space-between;background:#fff;border:1px solid #eee;padding:10px 14px;margin-top:8px;border-radius:8px;}
    .file-item a{text-decoration:none;color:#667eea;font-weight:600;}
    .file-actions button{margin-left:8px;}
    .status{margin-top:16px;padding:10px;border-radius:8px;display:none;}
    .success{background:#dff0d8;color:#3c763d;}
    .error{background:#f2dede;color:#a94442;}
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ TesteHTML Publisher Pro - COMPLETO</h1>
    <div class="stats">
      <div class="stat">Linhas: <span id="lineCount">0</span></div>
      <div class="stat">Caracteres: <span id="charCount">0</span></div>
      <div class="stat">Tamanho: <span id="sizeCount">0KB</span></div>
    </div>

    <label>Nome do arquivo (.html)</label>
    <input type="text" id="filename" value="minha-pagina.html" style="width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #ccc;">

    <div class="editor">
      <div class="editor-wrapper">
        <div id="lineNumbers" class="line-numbers"></div>
        <textarea id="htmlContent" spellcheck="false"><!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Exemplo</title>
</head>
<body>
  <h1>Publica√ß√£o Din√¢mica</h1>
  <p>Edite este c√≥digo e publique direto no GitHub!</p>
</body>
</html></textarea>
      </div>
    </div>

    <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap;">
      <button id="formatBtn" class="btn btn-secondary">Formatar</button>
      <button id="validateBtn" class="btn btn-secondary">Validar</button>
      <button id="clearBtn" class="btn btn-secondary">Limpar</button>
      <button id="publishBtn" class="btn btn-primary">üöÄ Publicar no GitHub</button>
    </div>

    <div id="status" class="status"></div>

    <div class="file-list">
      <h3>üìÅ Arquivos publicados</h3>
      <div id="fileList">Carregando...</div>
    </div>
  </div>

  <script>
    const config={repoOwner:'tehewdev',repoName:'tehew.space',folder:'testeHTML',previewBaseUrl:'https://tehew.space',binId:'68df49ae43b1c97be95893d1',accessKey:'$2a$10$f9KK7vSowGnJI5elo/dAPurqjZAJ3bJaWnsinl/caDfgIcNt28kNi'};
    let token=null;

    async function init(){await loadToken();updateEditorStats();listFiles();document.getElementById('htmlContent').addEventListener('input',updateEditorStats);document.getElementById('formatBtn').addEventListener('click',formatCode);document.getElementById('validateBtn').addEventListener('click',validateHTML);document.getElementById('clearBtn').addEventListener('click',()=>{if(confirm('Limpar editor?')){htmlContent.value='';updateEditorStats();}});document.getElementById('publishBtn').addEventListener('click',publish);}    

    function updateEditorStats(){const content=htmlContent.value;const lines=content.split('\n').length;lineCount.textContent=lines;charCount.textContent=content.length;sizeCount.textContent=(new Blob([content]).size/1024).toFixed(2)+' KB';let ln='';for(let i=0;i<lines;i++){ln+='<div>'+(i+1)+'</div>';}lineNumbers.innerHTML=ln;}

    function formatCode(){const lines=htmlContent.value.split(/>\s*</);let ind=0,res='';for(let l of lines){if(l.match(/^\//))ind--;res+='  '.repeat(ind)+'<'+l+'>\n';if(l.match(/^<?\w[^>]*[^\/]$/)&&!l.match(/(br|img|meta|link)/))ind++;}htmlContent.value=res.trim();updateEditorStats();}

    function validateHTML(){const c=htmlContent.value;if(!c.match(/<!DOCTYPE/i))return showStatus('Faltando <!DOCTYPE>', 'error');if(!c.match(/<html/i))return showStatus('Faltando <html>', 'error');if(!c.match(/<body/i))return showStatus('Faltando <body>', 'error');showStatus('‚úÖ HTML parece v√°lido!', 'success');}

    async function loadToken(){try{const r=await fetch('https://api.jsonbin.io/v3/b/'+config.binId+'/latest',{headers:{'X-Access-Key':config.accessKey,'X-Bin-Meta':'false'}});const d=await r.json();token=d.github_token;showStatus('Token carregado','success');}catch(e){showStatus('Erro token '+e.message,'error');}}

    async function publish(){const filename=document.getElementById('filename').value.trim();const content=document.getElementById('htmlContent').value;if(!filename||!content)return showStatus('Preencha tudo','error');const path=config.folder+'/'+filename;const url='https://api.github.com/repos/'+config.repoOwner+'/'+config.repoName+'/contents/'+path;const body={message:'Publicando '+filename,content:btoa(unescape(encodeURIComponent(content))),branch:'main'};const headers={'Authorization':'Bearer '+token,'Accept':'application/vnd.github+json','Content-Type':'application/json'};showStatus('‚è≥ Publicando...');try{const r=await fetch(url,{method:'PUT',headers,body:JSON.stringify(body)});const res=await r.json();if(!r.ok)throw new Error(res.message);showStatus('‚úÖ Publicado! <a href="'+config.previewBaseUrl+'/'+config.folder+'/'+encodeURIComponent(filename)+'" target="_blank">Ver p√°gina</a>','success');listFiles();}catch(e){showStatus('Erro: '+e.message,'error');}}

    async function listFiles(){if(!token)return;try{const url='https://api.github.com/repos/'+config.repoOwner+'/'+config.repoName+'/contents/'+config.folder+'?ref=main';const r=await fetch(url,{headers:{Authorization:'Bearer '+token}});const files=await r.json();if(!Array.isArray(files))throw new Error('Falha resposta');const html=files.filter(f=>f.name.endsWith('.html')).map(f=>`<div class='file-item'><div><a href='${config.previewBaseUrl}/${config.folder}/${f.name}' target='_blank'>${f.name}</a></div><div class='file-actions'><button onclick="loadFile('${f.name}')">‚úèÔ∏è</button><button onclick="deleteFile('${f.name}')">üóëÔ∏è</button></div></div>`).join('');document.getElementById('fileList').innerHTML=html||'Nenhum arquivo.';}catch(e){document.getElementById('fileList').innerHTML='Erro: '+e.message;}}

    async function loadFile(name){try{const url='https://api.github.com/repos/'+config.repoOwner+'/'+config.repoName+'/contents/'+config.folder+'/'+name;const r=await fetch(url,{headers:{Authorization:'Bearer '+token}});const d=await r.json();htmlContent.value=decodeURIComponent(escape(atob(d.content)));filename.value=name;updateEditorStats();showStatus('Arquivo carregado: '+name,'success');}catch(e){showStatus('Erro '+e.message,'error');}}

    async function deleteFile(name){if(!confirm('Apagar '+name+'?'))return;try{const url='https://api.github.com/repos/'+config.repoOwner+'/'+config.repoName+'/contents/'+config.folder+'/'+name;const r=await fetch(url,{headers:{Authorization:'Bearer '+token}});const d=await r.json();const body={message:'Removendo '+name,sha:d.sha,branch:'main'};await fetch(url,{method:'DELETE',headers:{Authorization:'Bearer '+token,'Content-Type':'application/json'},body:JSON.stringify(body)});showStatus('Removido '+name,'success');listFiles();}catch(e){showStatus('Erro '+e.message,'error');}}

    function showStatus(msg,type){const s=document.getElementById('status');s.innerHTML=msg;s.className='status '+type;s.style.display='block';}

    init();
  </script>
</body>
</html>